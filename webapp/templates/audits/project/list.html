{% extends 'layout/base-logged.html' %}
{% load i18n %}

{% block title %}{% translate "My Projects - Cosqua" %}{% endblock %}

{% block content %}
    <h1>{% translate "My Projects" %}</h1>

    <form method="get" action="{% url 'audits:project_list' %}" class="mb-6">
        <div class="flex gap-2">
            <input
                type="text"
                name="search"
                value="{{ request.GET.search }}"
                placeholder="{% translate 'Search by project name...' %}"
            >
            <button
                type="submit"
                class="btn btn-primary"
            >
                {% translate "Search" %}
            </button>
            {% if request.GET.search %}
                <a
                    href="{% url 'audits:project_list' %}"
                    class="btn btn-secondary"
                >
                    {% translate "Clear" %}
                </a>
            {% endif %}
        </div>
    </form>

    <div class="project-tiles">
        {% for project in object_list %}
            <a
                href="{% url 'audits:project_detail' project.slug %}"
                class="project-tile {% cycle 'tile-even' 'tile-odd' %}"
            >
                <h2>{{ project.name }}</h2>
                {% if project.description %}
                    <p>{{ project.description|truncatewords:5 }}</p>
                {% endif %}
                <p>
                    {% blocktranslate count count=project.resources.count|default:0 %}{{ count }} Resource{% plural %}{{ count }} Resources{% endblocktranslate %}
                </p>
                <p>
                    {% blocktranslate count count=project.audits.count|default:0 %}{{ count }} Audit{% plural %}{{ count }} Audits{% endblocktranslate %}
                </p>
            </a>
        {% empty %}
            <div class="project-tile project-tile-empty">
                <p>
                    {% if request.GET.search %}
                        {% translate "No projects found matching your search." %}
                    {% else %}
                        {% translate "No projects yet." %}
                    {% endif %}
                </p>
            </div>
        {% endfor %}
        <a href="{% url 'audits:project_form' %}" class="project-tile">
            <h2>{% translate "âž• Add a new project" %}</h2>
            <p>{% translate "Create a new project to start auditing your resources." %}</p>
        </a>
    </div>

{% endblock content %}
