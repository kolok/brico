## Brico – Project Notes

### Overview

- Two applications: `webapp/` (Django) and `mobileapp/` (Flutter).
- Shared services: PostgreSQL database via `docker-compose.yml` (`docker compose up -d`).
- Each subproject has its own `Makefile` with dev/build/test tasks.
- Documentation is available in `docs/`

### Webapp (`webapp/`)

- Backend: Django 5 + Django REST Framework, auth via `django-allauth` / `dj-rest-auth`.
- Python management: `uv` (Python ≥ 3.12). `make init-dev` sets up the environment, `make sync` installs dependencies, `make migrate` applies migrations.
- Running: `make run` (Honcho + `Procfile.dev`), `make run-all` launches Docker then the app.
- Tests & quality: `make test` (pytest), `make lint` (ruff), `make format` (black).
- i18n: `make makemessages` and `make compilemessages`, files in `locale/fr/LC_MESSAGES/`.

#### Associated Frontend

- Bundler: Parcel (`npm run build/watch/lint` scripts in `package.json`).
- Languages: TypeScript + CSS/Tailwind. Main entrypoints in `static/to_compile/entrypoints/` (`main.ts`, `main.css`).
- Asset organization:
  - `static/to_compile/`: code to transpile (TS/CSS).
  - `static/to_collect/`: assets copied as-is.
  - `static/compiled/`: Parcel output, cleaned by `make clean`.
- Hotwire: uses Stimulus + Turbo Frames.

### Mobile (`mobileapp/`)

- Stack: Flutter (SDK ≥ 3.3.1), multi-platform project (Android/iOS/Web/Desktop).
- Installation: `flutter pub get` (or `make install`).
- Running: `flutter run` (`make run`), `make hot-reload` for debug mode.
- Quality: `make analyze`, `make format`, `make test`, `make lint`.
- Builds: dedicated targets (`make build-android[-apk|-aab]`, `make build-ios`, `make build-web`, `make build-all`).

### Code Standards

- Python: PEP 8, type hints required, docstrings for public functions.
- TypeScript: ESLint + Prettier, camelCase naming.
- Flutter: official Dart conventions, prefer immutable widgets.
- Language: the application and documentation are all in English

### Testing Requirements

- Minimum coverage: 80% for webapp/backend.
- Mandatory tests: new features, bug fixes.
- CI must pass before merge (lint + tests).

### PR Workflow

- Template: see `.github/pull_request_template.md`.
- Self-review required before requesting review.
- Commits: explicit messages in French or English.
- No force-push on shared branches.

### Architecture Decisions

- Auth centralized via django-allauth (no custom JWT).
- Frontend: Hotwire/Turbo (no React/Vue SPA).
- Mobile: Flutter for multi-platform (no native).
- API: REST via DRF (no GraphQL currently).

### Points of Attention

- Do not commit `static/compiled/` (generated by Parcel).
- Always run migrations after pulling `main`.
- Mobile: ensure compatibility Android API 21+ and iOS 12+.
- i18n: `make compilemessages` after modifying `.po`.

### Configuration

- Webapp env vars: see `webapp/.env.template` (never commit `.env`).
- Sensitive secrets: use GitHub Secrets for CI.

### Quick References

- Root README: shared Docker instructions.
- `webapp/README.md`: UV/Django onboarding + translation management.
- `mobileapp/README.md`: Flutter prerequisites & basic commands.
